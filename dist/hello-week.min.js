function setAttr(t,e,s){return t.setAttribute(e,s)}function setStyle(t,e,s){return t.style.setProperty(e,s)}function addClass(t,e){return t.classList.add(e)}function removeClass(t,e){return t.classList.remove(e)}function toggleClass(t,e){return t.classList.toggle(e)}function getIndexForEventTarget(t,e){return Array.prototype.slice.call(t).indexOf(e)+1}function extend(t,e){if("function"==typeof Object.assign)return Object.assign(e,t);for(const s in e)t[s]=e[s];return t}function formatDate(t,e,s){return`${s}-${("0"+(e+1)).slice(-2)}-${("0"+t).slice(-2)}`}function timestampToHuman(t,e,s){const i=new Date(t);return new Intl.DateTimeFormat(e||config.lang,s||config.format).format(i)}function humanToTimestamp(t){if(t&&(!isNaN(Number(t))||3!==t.split("-").length))throw new Error(`The date ${t} is not valid!`);return t||"string"==typeof t?new Date(t+"T00:00:00Z").getTime():(new Date).setHours(0,0,0,0)}function render(t,e){if(t.split)return document.createTextNode(t);const s=document.createElement(t.nodeName),i=t.attributes||{};return Object.keys(i).forEach(t=>s.setAttribute(t,i[t])),(t.children||[]).forEach(t=>s.appendChild(render(t))),e?e.appendChild(s):s}function h(t,e,...s){const i={nodeName:t};return e&&(i.attributes=e),s.length&&(i.children=[].concat(...s)),i}function createElement(t,e){const s={};return s.navigation=render(h("div",{class:cssClasses.NAVIGATION}),t),s.prevMonth=render(h("div",{class:cssClasses.PREV},e.prev),s.navigation),s.period=render(h("div",{class:cssClasses.PERIOD}),s.navigation),s.nextMonth=render(h("div",{class:cssClasses.NEXT},e.next),s.navigation),s.week=render(h("div",{class:cssClasses.WEEK}),t),s.month=render(h("div",{class:cssClasses.MONTH}),t),s}const cssClasses={CALENDAR:"hello-week",DAY:"day",MONTH:"month",NAVIGATION:"navigation",NEXT:"next",PERIOD:"period",PREV:"prev",RTL:"rtl",WEEK:"week"},cssStates={IS_BEGIN_RANGE:"is-begin-range",IS_DISABLED:"is-disabled",IS_END_RANGE:"is-end-range",IS_HIGHLIGHT:"is-highlight",IS_SELECTED:"is-selected",IS_TODAY:"is-today",IS_WEEKEND:"is-weekend"},daysWeek={FRIDAY:5,MONDAY:1,SATURDAY:6,SUNDAY:0,THURSDAY:4,TUESDAY:2,WEDNESDAY:3},config={daysHighlight:null,daysSelected:null,defaultDate:null,disableDates:null,disableDaysOfWeek:null,disablePastDays:!1,format:{year:"numeric",month:"numeric",day:"numeric",timeZone:"UTC"},lang:"en",locked:!1,maxDate:null,minDate:null,monthShort:!1,multiplePick:!1,nav:["◀","▶"],range:!1,rtl:!1,selector:".hello-week",todayHighlight:!0,weekShort:!0,weekStart:0,onLoad:()=>{},onClear:()=>{},onNavigation:()=>{},onSelect:()=>{}};class HelloWeek{constructor(t={}){if(this.calendar={},this.daysSelected=[],this.intervalRange={},this.lastSelectedDay=0,this.options=extend(t,config),this.initOptions=extend(t,config),this.selector="string"==typeof this.options.selector?document.querySelector(this.options.selector):this.options.selector,null===this.selector)throw new Error("You need to specify a selector!");this.options.selector!==cssClasses.CALENDAR&&addClass(this.selector,cssClasses.CALENDAR),this.calendar=createElement(this.selector,{prev:this.options.nav[0],next:this.options.nav[1]}),console.log(this.calendar),this.options.rtl&&(addClass(this.calendar.week,cssClasses.RTL),addClass(this.calendar.month,cssClasses.RTL)),this.readFile("langs/"+this.options.lang+".json",t=>{this.langs=JSON.parse(t);this.init()})}readFile(t,e){const s=new XMLHttpRequest;s.overrideMimeType("application/json"),s.open("GET",t,!0),s.onreadystatechange=(()=>{4===s.readyState&&200===s.status&&e(s.responseText)}),s.send(null)}destroy(){this.removeStatesClass(),this.selector.remove()}prev(t){const e=this.date.getMonth()-1;this.date.setMonth(e),this.update(),this.options.onNavigation.call(this),t&&t.call(this)}next(t){const e=this.date.getMonth()+1;this.date.setMonth(e),this.update(),this.options.onNavigation.call(this),t&&t.call(this)}update(){this.clearCalendar(),this.mounted()}reset(t={},e){this.clearCalendar(),this.options=extend(t,this.initOptions),this.init(e)}goToday(){this.date=this.todayDate,this.date.setDate(1),this.update()}goToDate(t=this.todayDate){this.date=new Date(t),this.date.setDate(1),this.update()}getDays(){return this.daysSelected.map(t=>timestampToHuman(t,this.options.format,this.langs))}getDaySelected(){return this.lastSelectedDay}getDaysHighlight(){return this.daysHighlight}getMonth(){return this.date.getMonth()+1}getYear(){return this.date.getFullYear()}setDaysHighlight(t){this.daysHighlight=[...this.daysHighlight,...t]}setMultiplePick(t){this.options.multiplePick=t}setDisablePastDays(t){this.options.disablePastDays=t}setTodayHighlight(t){this.options.todayHighlight=t}setRange(t){this.options.range=t}setLocked(t){this.options.locked=t}setMinDate(t){this.options.minDate=new Date(t),this.options.minDate.setHours(0,0,0,0),this.options.minDate.setDate(this.options.minDate.getDate()-1)}setMaxDate(t){this.options.maxDate=new Date(t),this.options.maxDate.setHours(0,0,0,0),this.options.maxDate.setDate(this.options.maxDate.getDate()+1)}init(t){if(this.daysHighlight=this.options.daysHighlight?this.options.daysHighlight:[],this.daysSelected=this.options.daysSelected?this.options.daysSelected:[],this.daysSelected.length>1&&!this.options.multiplePick)throw new Error(`There are ${this.daysSelected.length} dates selected, but the multiplePick option\n                is ${this.options.multiplePick}!`);this.todayDate=humanToTimestamp(),this.date=new Date,this.defaultDate=new Date,this.options.defaultDate&&(this.date=new Date(this.options.defaultDate),this.defaultDate=new Date(this.options.defaultDate),this.defaultDate.setDate(this.defaultDate.getDate())),this.date.setDate(1),this.options.minDate&&this.setMinDate(this.options.minDate),this.options.maxDate&&this.setMaxDate(this.options.maxDate),this.mounted(),this.options.onLoad.call(this),t&&t.call(this)}selectDay(t){this.daysOfMonth=this.selector.querySelectorAll("."+cssClasses.MONTH+" ."+cssClasses.DAY);for(const e of Object.keys(this.daysOfMonth))this.handleClickInteraction(this.daysOfMonth[e],t),this.options.range&&this.handleMouseInteraction(this.daysOfMonth[e])}getIntervalOfDates(t,e){const s=[];let i=t;const a=t=>{const e=new Date(this.valueOf());e.setDate(e.getDate()+t);return e.getTime()};for(;i<=e;)s.push(timestampToHuman(i)),i=a.call(i,1);return s}handleClickInteraction(t,e){t.addEventListener("click",t=>{const s=getIndexForEventTarget(this.daysOfMonth,t.target);if(this.days[s].locked)return;this.lastSelectedDay=this.days[s].timestamp;this.options.range||(this.options.multiplePick?(this.days[s].timestamp&&(this.daysSelected=this.daysSelected.filter(t=>humanToTimestamp(t)!==this.lastSelectedDay)),this.days[s].isSelected||this.daysSelected.push(timestampToHuman(this.lastSelectedDay))):(this.days[s].locked||this.removeStatesClass(),this.daysSelected=[],this.daysSelected.push(timestampToHuman(this.lastSelectedDay))));toggleClass(t.target,cssStates.IS_SELECTED);this.days[s].isSelected=!this.days[s].isSelected;this.options.range&&(this.intervalRange.begin&&this.intervalRange.end&&(this.intervalRange.begin=void 0,this.intervalRange.end=void 0,this.removeStatesClass()),this.intervalRange.begin&&!this.intervalRange.end&&(this.intervalRange.end=this.days[s].timestamp,this.daysSelected=this.getIntervalOfDates(this.intervalRange.begin,this.intervalRange.end),addClass(t.target,cssStates.IS_END_RANGE),this.intervalRange.begin>this.intervalRange.end&&(this.intervalRange.begin=void 0,this.intervalRange.end=void 0,this.removeStatesClass())),this.intervalRange.begin||(this.intervalRange.begin=this.days[s].timestamp),addClass(t.target,cssStates.IS_SELECTED));this.options.onSelect.call(this);e&&e.call(this)})}handleMouseInteraction(t){t.addEventListener("mouseover",t=>{const e=getIndexForEventTarget(this.daysOfMonth,t.target);if(!this.intervalRange.begin||this.intervalRange.begin&&this.intervalRange.end)return;this.removeStatesClass();for(let t=1;t<=Object.keys(this.days).length;t++)if(this.days[t].isSelected=!1,this.days[e].timestamp>=this.intervalRange.begin){if(this.days[t].locked)return;this.days[t].timestamp>=this.intervalRange.begin&&this.days[t].timestamp<=this.days[e].timestamp&&(this.days[t].isSelected=!0,addClass(this.days[t].element,cssStates.IS_SELECTED),this.days[t].timestamp===this.intervalRange.begin&&addClass(this.days[t].element,cssStates.IS_BEGIN_RANGE))}})}creatWeek(t){const e=document.createElement("span");addClass(e,cssClasses.DAY),e.textContent=t,this.calendar.week.appendChild(e)}createMonth(){const t=this.date.getMonth();for(;this.date.getMonth()===t;)this.createDay(this.date),this.date.setDate(this.date.getDate()+1);this.date.setMonth(this.date.getMonth()-1),this.selectDay(()=>{})}createDay(t){const e=t.getDate(),s=t.getDay(),i=document.createElement("div"),a={day:e,timestamp:humanToTimestamp(formatDate(t.getDate(),t.getMonth(),t.getFullYear())),isWeekend:!1,locked:!1,isToday:!1,isSelected:!1,isHighlight:!1,element:void 0};this.days=this.days||{},i.textContent=String(a.day),addClass(i,cssClasses.DAY),1===a.day&&(this.options.weekStart===daysWeek.SUNDAY?setStyle(i,this.options.rtl?"margin-right":"margin-left",s*(100/Object.keys(daysWeek).length)+"%"):s===daysWeek.SUNDAY?setStyle(i,this.options.rtl?"margin-right":"margin-left",(Object.keys(daysWeek).length-this.options.weekStart)*(100/Object.keys(daysWeek).length)+"%"):setStyle(i,this.options.rtl?"margin-right":"margin-left",(s-1)*(100/Object.keys(daysWeek).length)+"%")),s!==daysWeek.SUNDAY&&s!==daysWeek.SATURDAY||(addClass(i,cssStates.IS_WEEKEND),a.isWeekend=!0),(this.options.locked||this.options.disableDaysOfWeek&&this.options.disableDaysOfWeek.includes(s)||this.options.disablePastDays&&+this.date.setHours(0,0,0,0)<=+this.defaultDate.setHours(0,0,0,0)-1||this.options.minDate&&+this.options.minDate>=a.timestamp||this.options.maxDate&&+this.options.maxDate<=a.timestamp)&&(addClass(i,cssStates.IS_DISABLED),a.locked=!0),this.options.disableDates&&this.setDaysDisable(i,a),this.todayDate===a.timestamp&&this.options.todayHighlight&&(addClass(i,cssStates.IS_TODAY),a.isToday=!0),this.daysSelected.find(t=>{t!==a.timestamp&&humanToTimestamp(t.toString())!==a.timestamp||(addClass(i,cssStates.IS_SELECTED),a.isSelected=!0)}),a.timestamp===this.intervalRange.begin&&addClass(i,cssStates.IS_BEGIN_RANGE),a.timestamp===this.intervalRange.end&&addClass(i,cssStates.IS_END_RANGE),this.daysHighlight&&this.setDayHighlight(i,a),this.calendar.month&&this.calendar.month.appendChild(i),a.element=i,this.days[a.day]=a}setDaysDisable(t,e){this.options.disableDates[0]instanceof Array?this.options.disableDates.map(s=>{e.timestamp>=humanToTimestamp(s[0])&&e.timestamp<=humanToTimestamp(s[1])&&(addClass(t,cssStates.IS_DISABLED),e.locked=!0)}):this.options.disableDates.map(s=>{e.timestamp===humanToTimestamp(s)&&(addClass(t,cssStates.IS_DISABLED),e.locked=!0)})}setDayHighlight(t,e){for(const s in this.daysHighlight)this.daysHighlight[s].days[0]instanceof Array?this.daysHighlight[s].days.map((i,a)=>{e.timestamp>=humanToTimestamp(i[0])&&e.timestamp<=humanToTimestamp(i[1])&&this.setStyleDayHighlight(t,s,e)}):this.daysHighlight[s].days.map(i=>{e.timestamp===humanToTimestamp(i)&&this.setStyleDayHighlight(t,s,e)})}setStyleDayHighlight(t,e,s){addClass(t,cssStates.IS_HIGHLIGHT),this.daysHighlight[e].title&&(s.tile=this.daysHighlight[e].title,setAttr(t,"data-title",this.daysHighlight[e].title)),this.daysHighlight[e].color&&setStyle(t,"color",this.daysHighlight[e].color),this.daysHighlight[e].backgroundColor&&setStyle(t,"background-color",this.daysHighlight[e].backgroundColor),s.isHighlight=!0}monthsAsString(t){return this.options.monthShort?this.langs.monthsShort[t]:this.langs.months[t]}weekAsString(t){return this.options.weekShort?this.langs.daysShort[t]:this.langs.days[t]}mounted(){const t=[];this.calendar.period&&(this.calendar.period.innerHTML=this.monthsAsString(this.date.getMonth())+" "+this.date.getFullYear()),this.calendar.week.textContent="";for(let e=this.options.weekStart;e<this.langs.daysShort.length;e++)t.push(e);for(let e=0;e<this.options.weekStart;e++)t.push(e);for(const e of t)this.creatWeek(this.weekAsString(e));this.createMonth()}clearCalendar(){this.calendar.month.textContent=""}removeStatesClass(){for(const t of Object.keys(this.daysOfMonth))removeClass(this.daysOfMonth[t],cssStates.IS_SELECTED),removeClass(this.daysOfMonth[t],cssStates.IS_BEGIN_RANGE),removeClass(this.daysOfMonth[t],cssStates.IS_END_RANGE),this.days[+t+1].isSelected=!1}}export{HelloWeek};
